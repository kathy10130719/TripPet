<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TripPet - å¸¶è‘— Kiki å»æ—…è¡Œ</title>
<style>
       :root {
           --primary-color: #FF9800;
           --bg-color: #FFF3E0;
       }
       body, html {
           margin: 0; padding: 0; width: 100%; height: 100%;
           font-family: -apple-system, sans-serif;
           background-color: var(--bg-color);
           overflow: hidden; /* é˜²æ­¢æ‹ç…§æ™‚ç•«é¢äº‚è·³ */
       }
       /* --- ç›¸æ©ŸèƒŒæ™¯å±¤ --- */
       #cameraContainer {
           position: fixed;
           top: 0; left: 0;
           width: 100%; height: 100%;
           z-index: -1; /* æ”¾åœ¨æœ€åº•å±¤ */
           background: #000;
           display: none; /* é è¨­é—œé–‰ */
       }
       #cameraFeed {
           width: 100%; height: 100%;
           object-fit: cover; /* è®“ç•«é¢å¡«æ»¿æ‰‹æ©Ÿè¢å¹• */
       }
       /* --- å®¹å™¨é™åˆ¶ --- */
       .app-container {
           max-width: 500px;
           margin: 0 auto;
           height: 100vh;
           display: flex;
           flex-direction: column;
           align-items: center;
           position: relative;
       }
       /* --- å‹•æ…‹å³¶ --- */
       .status-portal {
           width: 180px; height: 40px;
           background: rgba(0,0,0,0.8); /* ç¨å¾®é€æ˜æ›´æœ‰é«˜ç´šæ„Ÿ */
           border-radius: 25px;
           margin-top: 20px;
           display: flex; align-items: center;
           padding: 0 15px; color: white;
           box-shadow: 0 4px 15px rgba(0,0,0,0.3);
           z-index: 10;
       }
       .pet-in-island {
           font-size: 24px; margin-right: 12px;
           animation: walk-in-place 0.8s ease-in-out infinite alternate;
       }
       @keyframes walk-in-place {
           0% { transform: translateY(0px) rotate(0deg); }
           100% { transform: translateY(-4px) rotate(8deg); }
       }
       /* --- ä¸»ç•«é¢å¡ç‰‡ --- */
       .main-card {
           width: 85%; background: rgba(255,255,255,0.9);
           border-radius: 30px; margin-top: 30px;
           padding: 25px; text-align: center;
           transition: opacity 0.3s;
       }
       /* ç•¶ç›¸æ©Ÿé–‹å•Ÿæ™‚ï¼Œè®“å¡ç‰‡è®Šé€æ˜ä¸€é»ï¼Œæ‰ä¸æœƒæ“‹ä½é¢¨æ™¯ */
       .main-card.camera-on { opacity: 0.3; }
       .btn-camera {
           background-color: #4CAF50; /* ç¶ è‰²ä»£è¡¨å‡ºç™¼ */
           color: white; border: none;
           padding: 15px 30px; border-radius: 50px;
           font-size: 18px; cursor: pointer;
           margin-top: 20px; font-weight: bold;
       }
</style>
</head>
<body onload="initApp()">
<div id="cameraContainer">
<video id="cameraFeed" autoplay playsinline></video>
</div>
<div class="app-container">
<div class="status-portal">
<span class="pet-in-island" id="islandPetIcon">ğŸ¾</span>
<div id="displayPetName">è¼‰å…¥ä¸­...</div>
</div>
<div class="main-card" id="uiCard">
<h1>ğŸŒ TripPet æ—…éŠæ¨¡å¼</h1>
<p id="welcomeMessage">å“ˆå›‰ï¼é»æ“Šä¸‹æ–¹æŒ‰éˆ•è·Ÿ Kiki ä¸€èµ·çœ‹ä¸–ç•Œå§ï¼</p>
<button class="btn-camera" onclick="toggleCamera()">ğŸ“¸ é–‹å•Ÿå¯¦æ™¯æ¨¡å¼</button>
<br>
<button style="margin-top:20px; border:none; background:none; color:#999;" onclick="localStorage.clear(); location.reload();">é‡é¸å¯µç‰©</button>
</div>
</div>
<script>
       let isCameraOn = false;
       function initApp() {
           let name = localStorage.getItem("TripPet_Name") || "å°å¤¥ä¼´";
           let icon = localStorage.getItem("TripPet_Icon") || "ğŸ¶";
           document.getElementById('displayPetName').innerText = name;
           document.getElementById('islandPetIcon').innerText = icon;
       }
       // é–‹å•Ÿ/é—œé–‰ç›¸æ©Ÿçš„é‚è¼¯
       async function toggleCamera() {
           const container = document.getElementById('cameraContainer');
           const card = document.getElementById('uiCard');
           const video = document.getElementById('cameraFeed');
           if (!isCameraOn) {
               try {
                   // å‘æ‰‹æ©Ÿè«‹æ±‚ç›¸æ©Ÿæ¬Šé™
                   const stream = await navigator.mediaDevices.getUserMedia({
                       video: { facingMode: "environment" } // å¼·åˆ¶ä½¿ç”¨å¾Œé¡é ­
                   });
                   video.srcObject = stream;
                   container.style.display = 'block';
                   card.classList.add('camera-on');
                   isCameraOn = true;
               } catch (err) {
                   alert("å“å‘€ï¼ç„¡æ³•é–‹å•Ÿç›¸æ©Ÿï¼Œè«‹æª¢æŸ¥æ¬Šé™è¨­å®šå–”ï¼");
               }
           } else {
               // é—œé–‰ç›¸æ©Ÿ
               let tracks = video.srcObject.getTracks();
               tracks.forEach(track => track.stop());
               container.style.display = 'none';
               card.classList.remove('camera-on');
               isCameraOn = false;
           }
       }
</script>
</body>
</html>
